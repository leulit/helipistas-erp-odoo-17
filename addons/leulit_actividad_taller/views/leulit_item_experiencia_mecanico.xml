<?xml version='1.0' encoding='utf-8'?>
<odoo>
    

    <record id="leulit_20230616_1139_tree" model="ir.ui.view">
        <field name="name">leulit_20230616_1139_tree</field>
        <field name="model">leulit.item_experiencia_mecanico</field>
        <field name="arch" type="xml">
            <tree create="true" editable="bottom">
                <field name="mecanico_id"/>
                <field name="date"/>
                <field name="location"/>
                <field name="ac_type"/>
                <field name="ac_comp"/>
                <field name="type_maintenance"/>
                <field name="privilege" widget="many2many_tags" options="{'no_create': True, 'no_edit': False}"/>
                <field name="tipos_actividad_ids" widget="many2many_tags" options="{'no_create': True, 'no_edit': False}"/>
                <field name="ata_ids" widget="many2many_tags" options="{'no_create': True, 'no_edit': False}"/>
                <field name="operation_performed"/>
                <field name="duration" widget="float_time"/>
                <field name="maintenance_request_id" options="{'no_open': True, 'no_create': True, 'no_edit': False}"/>
                <field name="remarks"/>
            </tree>
        </field>
    </record>

    <record id="leulit_20230616_1139_action" model="ir.actions.act_window">
        <field name="name">Experiencia mecánico</field>
        <field name="res_model">leulit.item_experiencia_mecanico</field>
        <field name="view_mode">tree</field>
    </record>

    <report 
        id="leulit_20240521_1012_report"
        string="Registro Experiencia 6/24 - Mecánico"
        model="leulit.item_experiencia_mecanico"
        report_type="qweb-pdf"
        file="leulit_actividad_taller.leulit_20240521_1012_informe"
        name="leulit_actividad_taller.leulit_20240521_1012_informe"
        paperformat="leulit.paperformat_A4_landscape_without_cabecera"
    />
    
    <template id="experiencia_mecanico_report_css">
        <style>
            html {
                font-family: sans-serif;
                -ms-text-size-adjust: 100%;
                -webkit-text-size-adjust: 100%;
            }
            
            @page {
                size: A4 landscape;
                margin: 0;
            }
            
            .page-container {
                display: flex;
                flex-direction: column;
                max-height: 210mm;  /* Reducido para dar más control */
                margin: 10mm 7mm;   /* Margen uniforme */
                position: relative;
            }

            .content-wrapper {
                flex: 1;
                overflow: hidden;
            }
            
            .page-number-container {
                position: absolute;
                bottom: -15mm;      /* Posicionamiento ajustado */
                right: 0;
                text-align: right;
            }
            
            .page-number {
                font-size: 10px;
                padding-top: 5px;
                border-top: 1px solid black;
                display: inline-block;
                min-width: 100px;
            }
            
            .fullwidth {
                width: 100%;
                border-collapse: collapse;
            }

            .page {
                %if hashcode:
                    background: url(https://s3-eu-west-1.amazonaws.com/helimisc/helipistas-marca-agua.jpg) no-repeat 50% 50%;
                %else:
                    background: url(https://s3-eu-west-1.amazonaws.com/helimisc/helipistas-marca-agua-informe-interno-2.jpg) no-repeat 50% 50%;
                %endif
                width: 100%;
            }
            
            .main-table {
                width: 100%;
                border-collapse: separate;
                border-spacing: 0;
            }

            .report-header {
                display: table-header-group !important;
                break-inside: avoid;
                margin-bottom: 10px;
            }

            .tdcolored {
                background-color: rgba(0,0,0,0.40);
                color: #ffffff;
            }
            
            .centertext {
                text-align: center;
            }
            
            thead { 
                display: table-header-group;
            }
            
            tr { 
                page-break-inside: avoid;
            }
            
            th, tbody td, thead td {
                border: 1px solid #B0B0B0;
                padding: 2px;
                text-align: left;
                font-size: 11px;
                font-weight: normal;
                vertical-align: middle;
            }

            .header-table td {
                border: 1px solid #B0B0B0;
                padding: 2px;
            }

            .header-row-1 td {
                height: 35px;
            }
            
            .header-row-2 td {
                height: 100px;
            }
            
            tbody tr {
                height: 30px;
            }

            /* Ajustes específicos para la cabecera */
            .header-table td[style*="font-size:20px"] {
                font-size: 18px !important;
            }

            .header-table td[style*="font-size:12px"] {
                font-size: 11px !important;
            }

            .header-table img {
                height: 30px !important;
            }

            /* Ajustes para el contenido de las celdas */
            td[style*="max-height"] {
                height: 30px;
                max-height: 30px;
            }

            span[style*="max-height"] {
                max-height: 26px;
                -webkit-line-clamp: 2;
                display: -webkit-box;
                -webkit-box-orient: vertical;
                overflow: hidden;
            }
        </style>
    </template>

<!-- 
    <template id="">
        <t t-call="web.html_container">
            <t t-set="data_report_margin_top" t-value="5"/>
            <t t-set="data_report_header_spacing" t-value="1"/>
            <t t-set="data_report_dpi" t-value="90"/>
            <t t-set="contador" t-value="1"/>
            <t t-foreach="pages" t-as="page">
                <div class="page-container">
                    <t t-call="leulit_actividad_taller.experiencia_mecanico_report_css"/>
                    <div class="content-wrapper">
                        <table class="main-table">
                            <thead class="report-header">
                                <tr>
                                    <td colspan="100%" style="border:0px;">
                                        <table class="fullwidth header-table">
                                        </table>
                                    </td>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="page" t-as="item">
                                </t>
                            </tbody>
                        </table>
                    </div>
                    <div class="page-number-container">
                        <span class="page-number">
                            Página <t t-esc="contador"/> de <t t-esc="total_pages"/>
                        </span>
                    </div>
                    <t t-set="contador" t-value="contador + 1"/>
                </div>
            </t>
        </t>
    </template>
-->

    <template id="leulit_20240521_1012_informe">
        <t t-call="web.html_container">
            <t t-set="data_report_margin_top" t-value="5"/>
            <t t-set="data_report_header_spacing" t-value="1"/>
            <t t-set="data_report_dpi" t-value="90"/>
            <t t-set="contador" t-value="1"/>
            <t t-foreach="pages" t-as="page">
                <div class="page-container">
                    <t t-call="leulit_actividad_taller.experiencia_mecanico_report_css"/>
                    <div class="content-wrapper">
                        <table class="main-table">
                            <thead class="report-header">
                                <!-- Cabecera del reporte -->
                                <tr>
                                    <td colspan="100%" style="border:0px;">
                                        <table class="fullwidth header-table">
                                            <tr>
                                                <td style="font-size:12px; white-space: nowrap; text-align:center; width:25%;" rowspan="3">
                                                    <img t-att-src="'data:image/png;base64,%s' % to_text(logo_ica)" style="width:auto;height:30px;"/><br/>
                                                    <span>ES. 145.173</span>
                                                </td>
                                                <td style="font-size:20px; white-space: nowrap; text-align:center" rowspan="3">
                                                    <span><b>Registro Experiencia 6/24 meses de</b></span><br/>
                                                    <span t-esc="mecanico"/>
                                                </td>
                                                <td style="font-size:12px; white-space: nowrap; text-align:center; width:25%;">
                                                    <span>Referencia: M.O.E. 3.19</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="font-size:12px; white-space: nowrap; text-align:center;">
                                                    <span>Formato: 3-3</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="font-size:12px; white-space: nowrap; text-align:center">
                                                    <span>De: </span><span t-esc="from_date"/><span> Hasta: </span><span t-esc="to_date"/>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                                <!-- Headers de la tabla -->
                                <tr class="header-row-1">
                                    <td class="centertext literal tdcolored" rowspan="2" style="width:6%">Date</td>
                                    <td class="centertext literal tdcolored" rowspan="2" style="width:5%">Location</td>
                                    <td class="centertext literal tdcolored" rowspan="2" style="width:5%">A/C or Type</td>
                                    <td class="centertext literal tdcolored" rowspan="2" style="width:7%">A/C Reg. or Comp S/N</td>
                                    <td class="centertext literal tdcolored" rowspan="2" style="width:3%">Type of maint.</td>
                                    <td class="centertext literal tdcolored" rowspan="2" style="width:5%">Privilege used</td>
                                    <td class="centertext literal tdcolored" colspan="7" style="width:14%">Task Type</td>
                                    <td class="centertext literal tdcolored" colspan="4" style="width:9%">Type of Activity</td>
                                    <td class="centertext literal tdcolored" rowspan="2" style="width:3%">ATA</td>
                                    <td class="centertext literal tdcolored" rowspan="2" style="width:9%">Operation Performed</td>
                                    <td class="centertext literal tdcolored" rowspan="2" style="width:6%">Time Duration</td>
                                    <td class="centertext literal tdcolored" rowspan="2" style="width:9%">Maintenance record ref.</td>
                                    <td class="centertext literal tdcolored" rowspan="2" style="width:7%">Remarks</td>
                                </tr>
                                <tr class="header-row-2">
                                    <td class="centertext literal tdcolored">F<br/>O<br/>T</td>
                                    <td class="centertext literal tdcolored">S<br/>G<br/>H</td>
                                    <td class="centertext literal tdcolored">R<br/>/<br/>I</td>
                                    <td class="centertext literal tdcolored">T<br/>S</td>
                                    <td class="centertext literal tdcolored">M<br/>O<br/>D</td>
                                    <td class="centertext literal tdcolored">R<br/>E<br/>P</td>
                                    <td class="centertext literal tdcolored">I<br/>N<br/>S<br/>P</td>
                                    <td class="centertext literal tdcolored">T<br/>r<br/>a<br/>i<br/>n<br/>i<br/>n<br/>g</td>
                                    <td class="centertext literal tdcolored">P<br/>e<br/>r<br/>f<br/>o<br/>r<br/>m</td>
                                    <td class="centertext literal tdcolored">S<br/>u<br/>p<br/>e<br/>r<br/>v<br/>i<br/>s<br/>e</td>
                                    <td class="centertext literal tdcolored">C<br/>R<br/>S</td>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="page" t-as="item">
                                    <tr style="max-height: 60px !important;height: 60px !important;">
                                        <td style="height: 60px;" class="centertext"><t t-esc="item['date']"/></td>
                                        <td style="height: 60px;" class="centertext"><t t-esc="item['location']"/></td>
                                        <td style="height: 60px;" class="centertext"><t t-esc="item['ac_type']"/></td>
                                        <td style="height: 60px;" class="centertext"><t t-esc="item['ac_comp']"/></td>
                                        <td style="height: 60px;" class="centertext"><t t-esc="item['type_maintenance']"/></td>
                                        <td style="height: 60px;" class="centertext"><t t-esc="item['privilege']"/></td>
                                        <td style="height: 60px;" class="centertext"><t t-esc="item['fot']"/></td>
                                        <td style="height: 60px;" class="centertext"><t t-esc="item['sgh']"/></td>
                                        <td style="height: 60px;" class="centertext"><t t-esc="item['ri']"/></td>
                                        <td style="height: 60px;" class="centertext"><t t-esc="item['ts']"/></td>
                                        <td style="height: 60px;" class="centertext"><t t-esc="item['mod']"/></td>
                                        <td style="height: 60px;" class="centertext"><t t-esc="item['rep']"/></td>
                                        <td style="height: 60px;" class="centertext"><t t-esc="item['insp']"/></td>
                                        <td style="height: 60px;" class="centertext"><t t-esc="item['training']"/></td>
                                        <td style="height: 60px;" class="centertext"><t t-esc="item['perform']"/></td>
                                        <td style="height: 60px;" class="centertext"><t t-esc="item['supervise']"/></td>
                                        <td style="height: 60px;" class="centertext"><t t-esc="item['crs']"/></td>
                                        <td style="height: 60px;" class="centertext"><t t-esc="item['ata_ids']"/></td>
                                        <td style="max-height: 60px !important; height: 60px !important; overflow: hidden;" class="centertext">
                                            <span style="max-height: 42px !important; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden;">
                                                <t t-esc="item['operation_performed']"/>
                                            </span>
                                        </td>
                                        <td style="height: 60px;" class="centertext"><t t-esc="item['duration']"/></td>
                                        <td style="height: 60px;" class="centertext"><t t-esc="item['maintenance_record_ref']"/></td>
                                        <td style="max-height: 60px !important; height: 60px !important; overflow: hidden;" class="centertext">
                                            <span style="max-height: 55px !important; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden;">
                                                <t t-raw="item['remarks']"/>
                                            </span>
                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Paginación -->
                    <div class="page-number-container">
                        <span class="page-number">
                            Página <t t-esc="contador"/> de <t t-esc="total_pages"/>
                        </span>
                    </div>
                    <t t-set="contador" t-value="contador + 1"/>
                </div>
            </t>
        </t>
    </template>

</odoo>