<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">

        <record id="ir_cron_send_check_equipamientos_email" model="ir.cron">
            <field name="name">LEULIT - Enviar email de equipamientos</field>
            <field name="model_id" ref="model_calendar_event"/>
            <field name="state">code</field>
            <field name="code">model.check_equipamientos()</field>
            <field name="active" eval="False"/>
            <field name="interval_number">1</field>
            <field name="interval_type">days</field>
            <field name="numbercall" eval="-1"/>
        </record>

        <record id="email_template_check_equipamientos" model="mail.template">
            <field name="name">Notificaci√≥n de equipamientos dentro de 3 dias</field>
            <field name="model_id" ref="model_calendar_event"/>
            <field name="subject">Recordatorio de equipamientos para el evento: ${object.name}</field>
            <field name="email_from">erp@helipistas.com</field>
            <field name="email_to">${ctx.get('mail_to')}</field>
            <field name="body_html"><![CDATA[
                <p>
                    <strong>Nombre del evento:</strong> ${object.name}<br/>
                    <strong>Tipo:</strong> ${object.type_event.name}<br/>
                    <strong>Fecha y hora de inicio:</strong> ${object.start}<br/><br/>
                    <strong>Equipamientos:</strong>
                </p>
                <ul>
                    % for equipamiento in object.equipamientos_ids:
                        <li>${equipamiento.name}</li>
                    % endfor
                </ul>
            ]]></field>
        </record>

    </data>
</odoo>
