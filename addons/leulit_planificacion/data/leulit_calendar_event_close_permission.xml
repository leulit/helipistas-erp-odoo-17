<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">

        <record id="ir_cron_send_close_permission_email" model="ir.cron">
            <field name="name">LEULIT - Enviar email para cerrar permisos de eventos tipo SPO en la anterior semana</field>
            <field name="model_id" ref="model_calendar_event"/>
            <field name="state">code</field>
            <field name="code">model.close_permisos()</field>
            <field name="active" eval="True"/>
            <field name="interval_number">7</field>
            <field name="interval_type">days</field>
            <field name="numbercall" eval="-1"/>
        </record>

        <record id="email_template_close_permission_event" model="mail.template">
            <field name="name">Notificación de Cierre de Permisos para Eventos SPO</field>
            <field name="model_id" ref="model_calendar_event"/>
            <field name="subject">Cerrar permisos para el evento: ${object.name}</field>
            <field name="email_from">erp@helipistas.com</field>
            <field name="email_to">ops@helipistas.com</field>
            <field name="body_html"><![CDATA[
                <p>El evento programado es de tipo ${object.type_event.name}.</p>
                <p>
                    <strong>Nombre del evento:</strong> ${object.name}<br/>
                    % if not object.recurrence_id:
                        <strong>Fecha y hora de inicio:</strong> ${object.start}
                    % endif
                    % if object.recurrence_id:
                        <strong>Primer evento de la serie:</strong> ${object.recurrence_id.dtstart}<br/>
                        <strong>Último evento de la serie:</strong> ${object.recurrence_id.dtstop}
                    % endif
                </p>
                <p>
                    Por favor, proceda a cerrar los permisos correspondientes para este evento.
                </p>
            ]]></field>
        </record>

    </data>
</odoo>
