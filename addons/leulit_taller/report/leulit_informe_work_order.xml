<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="wo_report_css">
            <meta charset="utf-8"/>
            <style>
                /* RESET TOTAL PARA HEADER Y BODY */
                html, body {
                    margin: 0 !important;
                    padding: 0 !important;
                    width: 100% !important;
                    font-family: sans-serif;
                    font-size: 11px;
                    color: black;
                }
                
                /* SOLUCIÓN ANCHO HEADER: Elimina cualquier margen fantasma */
                .header {
                    margin: 0 !important;
                    padding: 0 !important;
                    width: 100% !important;
                }

                .fullwidth {
                    width: 100% !important;
                    border-collapse: collapse;
                }
                .noborde {
                    border: none !important;
                }
                
                /* CABECERA ESTABLE */
                .header-table {
                    width: 100% !important;
                    background-color: white; 
                    border-bottom: 2px solid black;
                    /* Un pequeño margen negativo horizontal a veces ayuda a clavar el ancho */
                    margin-left: 0px; 
                    margin-right: 0px;
                }

                /* SOLUCIÓN SALTO DE PÁGINA (PAGE BREAK) */
                /* Aplicamos 'avoid' a todo nivel posible para evitar cortes en medio de una fila */
                table {
                    page-break-inside: auto; /* La tabla puede cortarse... */
                }
                tr { 
                    page-break-inside: avoid !important; /* ...pero las filas NO */
                    page-break-after: auto;
                }
                td, th {
                    page-break-inside: avoid !important; /* Las celdas tampoco */
                }
                
                /* Estilos de Celdas */
                th, td {
                    border: 1px solid #aaa;
                    padding: 4px;
                    vertical-align: middle;
                    text-align: left;
                    line-height: 1.2;
                }
                .centertext { text-align:center; }
                .righttext { text-align:right; }
                
                .tdcolored {
                    background-color: #e9e9e9;
                    font-weight: bold;
                    color: black;
                    /* Importante para impresión: fuerza la impresión del fondo */
                    -webkit-print-color-adjust: exact; 
                    print-color-adjust: exact;
                }
                .tdcoloredmain {
                    background-color: black;
                    color: white;
                    font-weight: bold;
                    text-transform: uppercase;
                    -webkit-print-color-adjust: exact;
                    print-color-adjust: exact;
                }
                
                /* Configuración de cabecera de tabla */
                thead { 
                    display: table-header-group; /* Repite la cabecera en cada página */
                }
                tfoot { 
                    display: table-row-group; 
                }

                /* Footer */
                .footer-text {
                    font-size: 10px;
                    text-align: right;
                    border-top: 1px solid black;
                    padding-top: 4px;
                    width: 100%;
                }
            </style>
        </template>

        <template id="leulit_20230905_1226_informe">
            <t t-call="web.html_container">
                <t t-call="leulit_taller.wo_report_css"/>

                <div class="header">
                    <t t-if="logo_hlp">
                        <table class="fullwidth header-table">
                            <tr>
                                <td class="noborde centertext" style="width:30%; padding-bottom:5px;">
                                    <img t-att-src="'data:image/png;base64,%s' % logo_hlp" style="max-height:45px; width:auto; display:block; margin:0 auto;"/>
                                    <div style="font-size:10px; margin-top:2px;">ES.CAMO.005</div>
                                </td>
                                <td class="noborde centertext" style="width:40%; padding-bottom:5px;">
                                    <div style="font-size:18px; font-weight:bold;">WORK ORDER</div>
                                    <div style="font-size:14px;"><span t-esc="name"/></div>
                                </td>
                                <td class="noborde centertext" style="width:30%; font-size:10px; padding-bottom:5px;">
                                    <div>Formato 6</div>
                                    <div>Ed.4 Rev: 2</div>
                                    <div>28/09/2022</div>
                                </td>
                            </tr>
                        </table>
                    </t>
                    <t t-if="logo_ica">
                        <table class="fullwidth header-table">
                            <tr>
                                <td class="noborde centertext" style="width:25%; padding-bottom:5px;" rowspan="2">
                                    <img t-att-src="'data:image/png;base64,%s' % logo_ica" style="max-height:35px; width:auto; display:block; margin:0 auto;"/>
                                    <div style="font-size:10px;">ES. 145.173</div>
                                </td>
                                <td class="noborde centertext" style="width:50%; font-size:18px; padding-bottom:5px;">
                                    <b>WORK ORDER</b> <span t-esc="name"/>
                                </td>
                                <td class="noborde righttext" style="width:25%; font-size:10px; padding-bottom:5px;">
                                    Ref: M.O.E. 2.13<br/>
                                    Formato: 2.0<br/>
                                    Rev. 3-2023
                                </td>
                            </tr>
                        </table>
                    </t>
                </div>

                <div class="page">
                    <table class="fullwidth" style="margin-top: 5px;">
                        <tr>
                            <td rowspan="2" colspan="2" style="width:25%">
                                <b>Firma: </b><span t-esc="name_user"/>
                            </td>
                            <td class="tdcolored centertext" style="width:15%">Emisión</td>
                            <td class="tdcolored centertext" style="width:15%">Aceptación</td>
                            <td rowspan="2" class="noborde" style="width:45%; border:1px solid #aaa !important;">
                                <table class="fullwidth noborde">
                                    <tr class="noborde">
                                        <td class="noborde">
                                            <b>Firma:</b> ES. 145.173<br/>
                                            <span t-esc="responsable_mant"/>
                                        </td>
                                        <td class="noborde righttext">
                                            <img t-att-src="'data:image/png;base64,%s' % logo_p145" style="max-height:25px;"/>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td class="centertext"><span t-esc="fecha_emision"/></td>
                            <td class="centertext"><span t-esc="fecha_aceptacion"/></td>
                        </tr>
                        <tr>
                            <td class="tdcolored centertext">Matricula:</td>
                            <td><b><span t-esc="matricula"/></b></td>
                            <td colspan="2" class="tdcolored centertext">Propietario:</td>
                            <td colspan="2"><span t-esc="propietario_operador"/></td>
                        </tr>
                    </table>

                    <br/>

                    <table class="fullwidth">
                        <tr class="noborde">
                            <td class="noborde" style="width:10%"></td>
                            <td class="tdcolored centertext" style="width:20%">Aeronave</td>
                            <td class="tdcolored centertext" style="width:20%">Motor</td>
                            <td class="noborde" style="width:5%"></td>
                            <td rowspan="3" class="centertext" style="border:1px solid #aaa; padding:5px;">
                                <div style="font-size:10px;">Referencia Programa Mantenimiento:</div>
                                <div style="font-weight:bold; margin-top:5px;"><span t-esc="plan_mantenimiento"/></div>
                            </td>
                        </tr>
                        <tr>
                            <td class="tdcolored">Marca:</td>
                            <td><span t-esc="marca_aeronave"/></td>
                            <td><span t-esc="marca_motor"/></td>
                            <td class="noborde"></td>
                        </tr>
                        <tr>
                            <td class="tdcolored">Modelo:</td>
                            <td><span t-esc="modelo_aeronave"/></td>
                            <td><span t-esc="modelo_motor"/></td>
                            <td class="noborde"></td>
                        </tr>
                    </table>

                    <br/>

                    <table class="fullwidth">
                        <tr>
                            <td class="tdcolored" style="width:10%">S/N:</td>
                            <td style="width:20%"><span t-esc="sn_aeronave"/></td>
                            <td style="width:20%"><span t-esc="sn_motor"/></td>
                            <td class="tdcolored centertext" style="width:10%">C. Totales</td>
                            <td class="tdcolored centertext" style="width:10%">Ciclos NG</td>
                            <td class="tdcolored centertext" style="width:10%">Ciclos NF</td>
                            <td class="noborde"></td>
                        </tr>
                        <tr>
                            <td class="tdcolored">TSN:</td>
                            <td><span t-esc="tsn_aeronave"/></td>
                            <td><span t-esc="tsn_motor"/></td>
                            <td><span t-esc="ciclos_tsn"/></td>
                            <td><span t-esc="ciclos_ng_tsn"/></td>
                            <td><span t-esc="ciclos_nf_tsn"/></td>
                            <td class="noborde"></td>
                        </tr>
                        <tr>
                            <td class="tdcolored">TSO:</td>
                            <td><span t-esc="tso_aeronave"/></td>
                            <td><span t-esc="tso_motor"/></td>
                            <td><span t-esc="ciclos_tso"/></td>
                            <td><span t-esc="ciclos_ng_tso"/></td>
                            <td><span t-esc="ciclos_nf_tso"/></td>
                            <td class="noborde"></td>
                        </tr>
                    </table>

                    <br/>

                    <table class="fullwidth">
                        <thead>
                            <tr>
                                <td colspan="5" class="tdcoloredmain centertext">TRABAJOS A REALIZAR</td>
                            </tr>
                            <tr>
                                <td colspan="5" class="tdcolored centertext">Revisiones Programadas</td>
                            </tr>
                            <tr>
                                <td class="centertext" style="width:5%">Ítem</td>
                                <td style="width:50%">Descripción</td>
                                <td class="centertext" style="width:20%">Referencia</td>
                                <td class="centertext" style="width:12%">Realizado</td>
                                <td class="centertext" style="width:13%">Supervisado</td>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-set="cont" t-value="1"/>
                            <t t-foreach="trabajos_realizar" t-as="trabajo_tag">
                                <tr>
                                    <td class="centertext tdcolored"><b><span t-esc="cont"/></b></td>
                                    <td colspan="4" style="background-color:#f5f5f5; font-weight:bold;">
                                        <t t-if="trabajo_tag not in ['Others','']">Rev. <span t-esc="trabajo_tag"/>h</t>
                                        <t t-else=""><span t-esc="trabajo_tag"/></t>
                                    </td>
                                </tr>
                                <t t-foreach="trabajos_realizar[trabajo_tag]" t-as="tarea">
                                    <tr>
                                        <td class="centertext"><span t-esc="tarea[0]"/></td>
                                        <td><span t-esc="tarea[1]"/></td>
                                        <td class="centertext" style="font-size:10px;"><span t-esc="tarea[2]"/></td>
                                        <td class="centertext">
                                            <t t-if="tarea[5]"><b>N/A</b> </t>
                                            <span t-esc="tarea[3]"/>
                                        </td>
                                        <td class="centertext">
                                            <t t-if="tarea[5]"><b>N/A</b> </t>
                                            <span t-esc="tarea[4]"/>
                                        </td>
                                    </tr>
                                </t>
                                <t t-set="cont" t-value="cont+1"/>
                            </t>
                        </tbody>
                    </table>

                    <br/>
                    
                    <table class="fullwidth">
                        <tr><td class="tdcolored centertext">Observaciones / Notas</td></tr>
                        <tr><td style="height:60px; vertical-align:top;"><span t-esc="observaciones"/></td></tr>
                    </table>
                </div>

                <div class="footer">
                    <div class="footer-text">
                        Página <span class="page"/> de <span class="topage"/>
                    </div>
                </div>
            </t>
        </template>
    </data>
</odoo>