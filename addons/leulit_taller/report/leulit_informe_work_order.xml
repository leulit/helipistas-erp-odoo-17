<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <template id="wo_report_css">
            <meta charset="utf-8"/>
            <style>
                /* Reset general para que mande el Formato de Papel */
                html, body {
                    margin: 0 !important;
                    padding: 0 !important;
                    width: 100% !important;
                    font-family: sans-serif;
                    font-size: 12px;
                    color: black;
                }
                
                /* Clases de estructura */
                .header {
                    width: 100%;
                    margin: 0;
                    padding: 0;
                }
                .footer {
                    width: 100%;
                    margin: 0;
                    padding: 0;
                }
                .page {
                    width: 100%;
                    /* Eliminamos height fijo y background image si ya no se usa */
                    background-color: transparent; 
                }

                /* Tablas y Bordes */
                .fullwidth {
                    width: 100%;
                    border-collapse: collapse;
                }
                .noborde {
                    border: 0px none !important;
                }
                
                /* Gestión de Saltos de Página (CRÍTICO) */
                thead { display: table-header-group; } 
                tfoot { display: table-row-group; }
                tr { page-break-inside: avoid !important; }
                th, td { 
                    page-break-inside: avoid !important;
                    border: 1px solid #B0B0B0;
                    padding: 3px;
                    vertical-align: middle;
                    text-align: left;
                }

                /* Estilos Visuales (Tus colores originales) */
                .tdcolored {
                    background-color: rgba(0,0,0,0.40);
                    color: #ffffff;
                    -webkit-print-color-adjust: exact; /* Fuerza impresión de color */
                    print-color-adjust: exact;
                }
                .tdcoloredmain {
                    background-color: rgba(0,0,0,1);
                    color: #ffffff;
                    font-weight: bold;
                    text-transform: uppercase;
                    -webkit-print-color-adjust: exact;
                    print-color-adjust: exact;
                }
                .theadtitle {
                    font-weight: bold;
                    font-size: 3.5687mm !important;
                    text-transform: uppercase;
                }
                .literal, .fieldvalue {
                    font-size: 3.5687mm;
                }
                .fieldvalue { font-weight: normal; }
                .centertext { text-align:center; }
                .heightrow { height: 50px; }

                /* Footer simple */
                .footer-text {
                    width: 100%;
                    border-top: 1px solid black;
                    text-align: right;
                    font-size: 10px;
                }
            </style>
        </template>

        <template id="leulit_20230905_1226_informe">
            <t t-call="web.html_container">
                <t t-call="leulit_taller.wo_report_css"/>

                <div class="header">
                    <t t-call="leulit_taller.wo_report_css"/>
                    <t t-if="logo_hlp">
                        <table class="fullwidth">
                            <tr>
                                <td  style="font-size:12px; white-space: nowrap; text-align:center; width:33%;" rowspan="2">
                                    <img t-att-src="'data:image/png;base64,%s' % to_text(logo_hlp)" style="width:auto;height:50px;"/><br/>
                                    <span>ES.CAMO.005</span>    
                                </td>
                                <td  style="font-size:20px; white-space: nowrap; text-align:center; width:33%;">
                                    <span><b>WORK ORDER</b></span>
                                </td>
                                <td  style="font-size:12px; white-space: nowrap; text-align:center; width:33%;">
                                    <span>Formato 6</span>
                                </td>
                            </tr>
                            <tr>
                                <td  style="font-size:18px; white-space: nowrap; text-align:center">
                                    <span t-esc="name"/>
                                </td>
                                <td  style="font-size:12px; white-space: nowrap; text-align:center">
                                    <span>Ed.4 Rev: 2</span><br/>
                                    <span>28/09/2022</span>
                                </td>
                            </tr>
                        </table>
                    </t>
                    <t t-if="logo_ica">
                        <table class="fullwidth" style="border-bottom: 2px solid black; background: white;">
                            <tr>
                                <td  style="font-size:12px; white-space: nowrap; text-align:center; width:33%;" rowspan="3">
                                    <img t-att-src="'data:image/png;base64,%s' % to_text(logo_ica)" style="width:auto;height:30px;"/><br/>
                                    <span>ES. 145.173</span>
                                </td>
                                <td  style="font-size:20px; white-space: nowrap; text-align:center; width:33%;" rowspan="2">
                                    <span><b>WORK ORDER</b></span>
                                </td>
                                <td  style="font-size:12px; white-space: nowrap; text-align:center; width:17%;">
                                    <span>Referencia:</span>
                                </td>
                                <td  style="font-size:12px; white-space: nowrap; text-align:center; width:16%;">
                                    <span>M.O.E. 2.13</span>
                                </td>
                            </tr>
                            <tr>
                                <td  style="font-size:12px; white-space: nowrap; text-align:center">
                                    <span>Formato:</span>
                                </td>
                                <td  style="font-size:12px; white-space: nowrap; text-align:center">
                                    <span>2.0</span>
                                </td>
                            </tr>
                            <tr>
                                <td  style="font-size:18px; white-space: nowrap; text-align:center">
                                    <span t-esc="name"/>
                                </td>
                                <td  style="font-size:12px; white-space: nowrap; text-align:center">
                                    <span>Revisión:</span>
                                </td>
                                <td  style="font-size:12px; white-space: nowrap; text-align:center">
                                    <span>Rev. 3-2023</span>
                                </td>
                            </tr>
                        </table>
                    </t>
                </div>

                <div class="page">
                    <table class="fullwidth">
                        <tr>
                            <td rowspan="2" colspan="2" style="width:22%">
                                <span style="vertical-align: text-top;"><b>Firma: </b><span t-esc="name_user"/></span>
                            </td>
                            <th class="centertext tdcolored literal" style="width:18%">Fecha Emisión</th>
                            <th class="centertext tdcolored literal" style="width:18%">Fecha Aceptación</th>
                            <td rowspan="2" style="border-right: none;">
                                <b>Firma:</b>
                                <span>ES. 145.173</span><br/>
                                <span t-esc="responsable_mant"/>
                            </td>
                            <td rowspan="2" style="border-left: none; text-align:right;">
                                <img t-att-src="'data:image/png;base64,%s' % logo_p145" style="width:auto; height:25px;"/>
                            </td>
                        </tr>
                        <tr>
                            <td class="fieldvalue centertext"><span t-esc="fecha_emision"/></td>
                            <td class="fieldvalue centertext"><span t-esc="fecha_aceptacion"/></td>
                        </tr>
                        <tr>
                            <td class="centertext tdcolored literal">Matricula:</td>
                            <td class="fieldvalue"><span t-esc="matricula"/></td>
                            <td colspan="2" class="centertext tdcolored literal">Propietario/Operador:</td>
                            <td colspan="2" class="fieldvalue"><span t-esc="propietario_operador"/></td>
                        </tr>
                    </table>

                    <table class="fullwidth" style="margin-top:10px; border-bottom:none;">
                        <tr class="noborde">
                            <td class="centertext tdcolored literal" style="width:10%;"></td>
                            <td class="centertext tdcolored literal" style="width:20%;">Aeronave</td>
                            <td class="centertext tdcolored literal" style="width:20%;">Motor</td>
                            <td colspan="4" rowspan="3" style="width:50%;" class="noborde">
                                <div style="margin-left:5%; margin-right:5%; border:1px solid #B0B0B0; text-align:center; padding:10px;">
                                    <span>Referencia Programa Mantenimiento:</span><br/><br/>
                                    <b><span t-esc="plan_mantenimiento"/></b>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td class="tdcolored literal">Marca:</td>
                            <td class="fieldvalue"><span t-esc="marca_aeronave"/></td>
                            <td class="fieldvalue"><span t-esc="marca_motor"/></td>
                        </tr>
                        <tr style="border-bottom:none;">
                            <td class="tdcolored literal">Modelo:</td>
                            <td class="fieldvalue"><span t-esc="modelo_aeronave"/></td>
                            <td class="fieldvalue"><span t-esc="modelo_motor"/></td>
                        </tr>
                    </table>

                    <table class="fullwidth">
                        <tr>
                            <td class="tdcolored literal" style="width:10%;">S/N:</td>
                            <td class="fieldvalue" style="width:20%;"><span t-esc="sn_aeronave"/></td>
                            <td class="fieldvalue" style="width:20%;"><span t-esc="sn_motor"/></td>
                            <td class="centertext tdcolored literal" style="width:10%;">C. Totales</td>
                            <td class="centertext tdcolored literal" style="width:10%;">Ciclos NG</td>
                            <td class="centertext tdcolored literal" style="width:10%;">Ciclos NF</td>
                            <td style="width:20%;" class="noborde"></td>
                        </tr>
                        <tr>
                            <td class="tdcolored literal">TSN:</td>
                            <td class="fieldvalue"><span t-esc="tsn_aeronave"/></td>
                            <td class="fieldvalue"><span t-esc="tsn_motor"/></td>
                            <td class="fieldvalue"><span t-esc="ciclos_tsn"/></td>
                            <td class="fieldvalue"><span t-esc="ciclos_ng_tsn"/></td>
                            <td class="fieldvalue"><span t-esc="ciclos_nf_tsn"/></td>
                            <td class="noborde"></td>
                        </tr>
                        <tr>
                            <td class="tdcolored literal">TSO:</td>
                            <td class="fieldvalue"><span t-esc="tso_aeronave"/></td>
                            <td class="fieldvalue"><span t-esc="tso_motor"/></td>
                            <td class="fieldvalue"><span t-esc="ciclos_tso"/></td>
                            <td class="fieldvalue"><span t-esc="ciclos_ng_tso"/></td>
                            <td class="fieldvalue"><span t-esc="ciclos_nf_tso"/></td>
                            <td class="noborde"></td>
                        </tr>
                    </table>

                    <br/>

                    <table class="fullwidth">
                        <thead>
                            <tr>
                                <td colspan="5" class="centertext fullwidth tdcoloredmain theadtitle">TRABAJOS A REALIZAR</td>
                            </tr>
                            <tr>
                                <td colspan="5" class="centertext fullwidth tdcolored literal">Revisiones Programadas</td>
                            </tr>
                            <tr>
                                <td class="centertext literal" style="width:5%;">Ítem</td>
                                <td class="literal" style="width:58%;">Descripción de los trabajos a efectuar</td>
                                <td class="centertext literal" style="width:13%;">Referencia</td>
                                <td class="centertext literal" style="width:12%;">Realizado</td>
                                <td class="centertext literal" style="width:12%;">Supervisado</td>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-set="cont" t-value="1"/>
                            <t t-foreach="trabajos_realizar" t-as="trabajo_tag">
                                <tr>
                                    <td class="fieldvalue centertext tdcolored"><b><span t-esc="cont"/></b></td>
                                    <td class="fieldvalue" colspan="4" style="background-color:#eee;">
                                        <t t-if="trabajo_tag not in ['Others','']">Rev. <span t-esc="trabajo_tag"/>h</t>
                                        <t t-else=""><span t-esc="trabajo_tag"/></t>
                                    </td>
                                </tr>
                                <t t-foreach="trabajos_realizar[trabajo_tag]" t-as="tarea">
                                    <tr>
                                        <td class="fieldvalue centertext heightrow"><span t-esc="tarea[0]"/></td>
                                        <td class="fieldvalue heightrow"><span t-esc="tarea[1]"/></td>
                                        <td class="fieldvalue centertext heightrow" style="font-size:10px;"><span t-esc="tarea[2]"/></td>
                                        <td class="fieldvalue heightrow centertext">
                                            <t t-if="tarea[5]"><b>N/A</b></t>
                                            <span t-esc="tarea[3]"/>
                                        </td>
                                        <td class="fieldvalue heightrow centertext">
                                            <t t-if="tarea[5]"><b>N/A</b></t>
                                            <span t-esc="tarea[4]"/>
                                        </td>
                                    </tr>
                                </t>
                                <t t-set="cont" t-value="cont+1"/>
                            </t>
                        </tbody>
                    </table>

                    <br/>
                    
                    <table class="fullwidth" t-if="service_bulletins">
                        <thead>
                            <tr>
                                <td class="centertext fullwidth tdcolored literal" colspan="4">Boletines de Servicio y Directivas de Aeronavegabilidad</td>
                            </tr>
                            <tr>
                                <td class="centertext literal" style="width:5%;">Ítem</td>
                                <td class="literal" style="width:60%;">Descripción</td>
                                <td class="centertext literal" style="width:20%;">Referencia</td>
                                <td class="centertext literal" style="width:15%;">Realizado por</td>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-foreach="service_bulletins" t-as="tarea">
                                <tr>
                                    <td class="fieldvalue centertext heightrow"><span t-esc="tarea['item']"/></td>
                                    <td class="fieldvalue heightrow"><span t-esc="tarea['name']"/></td>
                                    <td class="fieldvalue centertext heightrow"><span t-raw="tarea['referencia']"/></td>
                                    <td class="fieldvalue heightrow"><span t-esc="tarea['asignado']"/></td>
                                </tr>
                            </t>
                        </tbody>
                    </table>
                    
                    <br t-if="service_bulletins"/>

                    <table class="fullwidth" t-if="anomalias">
                        <thead>
                            <tr>
                                <td class="centertext fullwidth tdcolored literal" colspan="4">Instrucciones Especiales y o Anomalías reportadas</td>
                            </tr>
                            <tr>
                                <td class="centertext literal" style="width:5%;">Ítem</td>
                                <td class="literal" style="width:60%;">Descripción</td>
                                <td class="centertext literal" style="width:20%;">Referencia</td>
                                <td class="centertext literal" style="width:15%;">Realizado por</td>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-foreach="anomalias" t-as="anomalia">
                                <tr>
                                    <td class="fieldvalue centertext heightrow"><span t-esc="anomalia['item']"/></td>
                                    <td class="fieldvalue heightrow"><span t-esc="anomalia['name']"/></td>
                                    <td class="fieldvalue centertext heightrow"><span t-raw="anomalia['referencia']"/></td>
                                    <td class="fieldvalue heightrow"><span t-esc="anomalia['asignado']"/></td>
                                </tr>
                            </t>
                        </tbody>
                    </table>

                    <br t-if="anomalias"/>

                    <table class="fullwidth">
                        <thead>
                            <tr>
                                <td class="centertext fullwidth tdcolored literal" colspan="9">Sustitución de Componentes</td>
                            </tr>
                            <tr>
                                <td class="" style="width:5%;"></td>
                                <td class="centertext literal" style="width:15%;">P/N</td>
                                <td class="centertext literal" style="width:15%;">S/N</td>
                                <td class="centertext literal" style="width:34%;">Descripción</td>
                                <td class="centertext literal" style="width:8%;">TSN</td>
                                <td class="centertext literal" style="width:8%;">TSO</td>
                                <td class="centertext literal" style="width:20%;">Realizado por</td>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-if="moves_componentes">
                                <t t-foreach="moves_componentes" t-as="move_componente">
                                    <tr>
                                        <td class="centertext literal">OFF</td>
                                        <td class="fieldvalue heightrow centertext"><span t-esc="move_componente['off_pn']"/></td>
                                        <td class="fieldvalue centertext"><span t-esc="move_componente['off_sn']"/></td>
                                        <td class="fieldvalue centertext"><span t-esc="move_componente['off_descripcion']"/></td>
                                        <td class="fieldvalue centertext"><span t-esc="move_componente['off_tsn']"/></td>
                                        <td class="fieldvalue centertext"><span t-esc="move_componente['off_tso']"/></td>
                                        <td class="fieldvalue centertext"><span t-esc="move_componente['off_realizado_por']"/></td>
                                    </tr>
                                    <tr>
                                        <td class="centertext literal">ON</td>
                                        <td class="fieldvalue heightrow centertext"><span t-esc="move_componente['on_pn']"/></td>
                                        <td class="fieldvalue centertext"><span t-esc="move_componente['on_sn']"/></td>
                                        <td class="fieldvalue centertext"><span t-esc="move_componente['on_descripcion']"/></td>
                                        <td class="fieldvalue centertext"><span t-esc="move_componente['on_tsn']"/></td>
                                        <td class="fieldvalue centertext"><span t-esc="move_componente['on_tso']"/></td>
                                        <td class="fieldvalue centertext"><span t-esc="move_componente['on_realizado_por']"/></td>
                                    </tr>
                                </t>
                            </t>
                            <t t-else="">
                                <tr>
                                    <td class="centertext literal">OFF</td>
                                    <td class="fieldvalue heightrow"></td><td></td><td></td><td></td><td></td><td></td>
                                </tr>
                                <tr>
                                    <td class="centertext literal">ON</td>
                                    <td class="fieldvalue heightrow"></td><td></td><td></td><td></td><td></td><td></td>
                                </tr>
                            </t>
                        </tbody>
                    </table>

                    <br/>
                    
                    <table class="fullwidth">
                        <tr>
                            <td class="centertext fullwidth tdcolored literal">Observaciones / Notas</td>
                        </tr>
                        <tr>
                            <td class="fieldvalue" style="height: 100px; vertical-align:top;">
                                <span t-esc="observaciones"/>
                            </td>
                        </tr>
                    </table>
                </div> 

                <div class="footer">
                    <div class="footer-text">
                        Página <span class="page"/> de <span class="topage"/>
                    </div>
                </div> 
            </t>
        </template>
    </data>
</odoo>