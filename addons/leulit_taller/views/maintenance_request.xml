<?xml version='1.0' encoding='utf-8'?>
<odoo>
    <data>

        <record id="leulit_20231020_1222_search" model="ir.ui.view">
            <field name="name">leulit_20231020_1222_search</field>
            <field name="model">maintenance.request</field>
            <field name="inherit_id" ref="maintenance.hr_equipment_request_view_search"/>
            <field name="arch" type="xml">
                <xpath expr="//group" position="after">
                    <filter string='Helicóptero' name='equipamiento' domain="[]" context="{'group_by': 'equipment_id'}"/>
                </xpath>
            </field>
        </record>


        <record id="leulit_20231020_1222_form" model="ir.ui.view">
            <field name="name">leulit_20231020_1222_form</field>
            <field name="model">maintenance.request</field>
            <field name="arch" type="xml">
                <form string="Petición de mantenimiento">
                    <header>
                        <button string="Cancelar" name="archive_equipment_request" type="object"  invisible="((archive))" />
                        <button string="Reabrir solicitud" name="reset_equipment_request" type="object"  invisible="((not archive))"  modifiers="{'invisible':[['archive','=',false]]}" />
                        <field name="stage_id" widget="statusbar" options="{'clickable': '1'}"  invisible="((archive))" />
                        <button name="action_create_internal_task" type="object" class="oe_highlight" string="Crear Tarea interna"  invisible="((archive) or (maintenance_plan_id))" />
                        <button name="action_create_defect_found" type="object" class="oe_highlight" string="Crear Defecto encontrado"  invisible="((archive))" />
                        <button name="action_create_task_sb" type="object" class="oe_highlight" string="Crear Tarea Service Bulletin"  invisible="((archive))" />
                        <button name="action_create_task_ad" type="object" class="oe_highlight" string="Crear Tarea Airworthiness directive"  invisible="((archive))" />
                        <button name="action_open_tasks" type="object" class="oe_highlight" string="Tareas"  invisible="((archive))"  context="{'create':False}"/>        
                        <button string="Validación CAMO" name="validate_order_by_camo" type="object"  invisible="(((stage_id != 3) or (not maintenance_plan_id)) or (validated))"  groups="leulit.RCAMO_base"/>
                        <field name="maintenance_plan_id" invisible="1"/>
                        <field name="validated" invisible="1"/>
                        <button string="Expediente de Mantenimiento" name="print_expediente_mantenimiento" type="object" class="oe_highlight"/>
                    </header>
                    <sheet>
                        <div  invisible="((not archive))" >
                            <span class="badge badge-warning float-right">Cancelado</span>
                        </div>
                        <div class="oe_right">
                            <field name="kanban_state" class="oe_inline" widget="state_selection"/>
                        </div>
                        <div class="oe_button_box" name="button_box">
                            <button class="oe_stat_button" type="object" name="action_view_timesheet_ids" icon="fa-calendar" >
                                <field name="timesheet_total_hours" widget="timesheet_uom"/><span class="o_label" style="padding-left: 5px;">horas</span>
                            </button>
                        </div>
                        <div class="oe_title">
                            <label for="name" class="oe_edit_only" string="Título"/>
                            <h1><field name="name" placeholder="Petición de mantenimiento" modifiers="{'required':true}" id="name"  readonly="((done))" /></h1>
                        </div>
                        <group>
                            <group>
                                <field name="employee_id" string="Creado por" options="{'no_create_edit': True, 'no_open': True}"  readonly="((done))" />
                                <field name="equipment_id" string="Equipamiento" context="{'default_company_id':company_id, 'default_category_id':category_id}"  readonly="((done))" />
                                <field name="lot_id"  readonly="((done))" />
                                <field name="category_id" context="{'default_company_id':company_id}"  invisible="((not equipment_id))" />
                                <field name="request_date"  readonly="((done))" />
                                <field name="done" invisible="1"/>
                                <field name="accepted" invisible="1"/>
                                <field name="fecha_aceptacion" widget="date"  invisible="((not accepted))" readonly="((done))" />
                                <field name="close_date"  invisible="((not done))"  groups="leulit.RCAMO_base"/>
                                <field name="archive" invisible="1"/>
                                <field name="maintenance_type" invisible="1"/>
                                <field name="maintenance_kind_id"  readonly="((done))" />
                                <field name="horometro"  readonly="((done))" />
                                <field name="referencia_programa_mantenimiento"  invisible="((maintenance_plan_id))" />
                                <field name="overhaul_tasks"/>
                            </group>
                            <group>
                                <field name="location"  readonly="((done))" />
                                <field name="maintenance_team_id" options="{'no_create': True, 'no_open': True}"  readonly="((done))" />
                                <field name="user_id" string="Responsable"  readonly="((done))" />
                                <field name="schedule_date"  readonly="((done))" />
                                <label for="duration"/>
                                <div>
                                    <field name="duration" widget="float_time" class="oe_inline"  readonly="((done))" /><span class="ml8">horas</span>
                                </div>
                                <field name="priority" widget="priority"  readonly="((done))" />
                                <field name="project_id"  readonly="((done))" />
                                <field name="task_id" invisible="1"/>
                                <field name="email_cc" string="Correo electrónico cc"  readonly="((done))" />
                                <field name="company_id" options="{'no_create': True}"  readonly="((done))" />
                            </group>
                        </group>
                        <group>
                            <button name="print_wo" type="object" class="oe_highlight" string="Imprimir Work Order"  invisible="((archive))"   />
                            <button name="print_inspeccion_seguridad" type="object" class="oe_highlight" string="Imprimir Inspección de Seguridad"  invisible="((archive))"   />
                            <button name="print_defectos" type="object" class="oe_highlight" string="Imprimir Defectos encontrados durante el mantenimiento"  invisible="((archive))"   />
                            <button name="print_doble_check" type="object" class="oe_highlight" string="Imprimir Control de Doble Check"  invisible="((archive))"   />
                        </group>
                        <notebook>
                            <page name="page_datos_helicoptero" string="Datos Helicóptero">
                                <group col="4">
                                    <field name="helicoptero"/>
                                    <field name="fabricante"/>
                                    <field name="modelo"/>
                                    <field name="serialnum"/>
                                    <field name="tsn"/>
                                    <field name="tso"/>
                                </group>
                            </page>
                            <page name="page_material" string="Material">
                                <button name="print_material" type="object" class="oe_highlight" string="Imprimir Material"  invisible="((not material_ids))" />
                                <button name="create_sale_order_from_material_utilizado" type="object" class="" string="Crear Presupuesto de Venta"  invisible="((not material_ids) or (sale_order_id))" />
                                <button name="open_sale_order" type="object" class="" string="Abrir Presupuesto de Venta"  invisible="((not sale_order_id))" />
                                <group>
                                    <field name="sale_order_id"/>
                                    <!-- <field name="sale_order_id" groups="leulit.RolIT_developer"/> -->
                                </group>
                                <field name="material_ids">
                                    <tree create="false" edit="false">
                                        <field name="date"/>
                                        <field name="reference"/>
                                        <field name="product_id"/>
                                        <field name="lot_id"/>
                                        <field name="location_id"/>
                                        <field name="location_dest_id"/>
                                        <field name="quantity"/>
                                    </tree>
                                </field>
                            </page>
                            <page name="page_tareas_sensibles_seguridad" string="Tareas Sensibles para la Seguridad">
                                <button name="print_tareas_sensibles_seguridad" type="object" class="oe_highlight" string="Imprimir Control de Tareas Sensibles para la Seguridad"  invisible="((archive))" />        
                                <group><field name="checklist_tss"/></group>
                                <field name="tareas_sensibles_seguridad_ids">
                                    <tree editable="false" create="false" delete="false">
                                        <field name="name" readonly="1"/>
                                        <field name="no_aplica"/>
                                        <field name="check"/>
                                        <field name="user_check"  options="{'no_create': True, 'create': False, 'edit': False}"/>
                                        <field name="datetime_check"/>
                                        <field name="d_check"/>
                                        <field name="user_d_check"  options="{'no_create': True, 'create': False, 'edit': False}"/>
                                        <field name="datetime_d_check"/>
                                        <field name="flag_doble_check" column_invisible="1"/>
                                        <field name="flag_security_inspection" column_invisible="1"/>
                                    </tree>
                                </field>
                            </page>
                            <page name="page_boroscopia" string="Boroscopias">
                                <button name="action_create_boroscopia" type="object" class="oe_highlight" string="Crear Boroscopia"  invisible="((archive))" />
                                <field name="boroscopia_ids">
                                    <tree editable="false" create="false">
                                        <field name="estado" readonly="1"/>
                                        <field name="name" readonly="1"/>
                                        <field name="lugar" readonly="1"/>
                                        <field name="fecha" readonly="1"/>
                                        <field name="mecanico" readonly="1"/>
                                        <button name="edit_boroscopia" string="Editar" class="oe_highlight" type="object"/>
                                        <button name="print_boroscopia" string="Imprimir" type="object" class="oe_highlight"/>
                                    </tree>
                                </field>
                            </page>
                            <page name="page_crs" string="CRS">
                                <button name="action_create_maintenance_crs_incompleto" type="object" class="oe_highlight" string="Crear CRS Incompleto"  invisible="((archive))" />
                                <button name="action_create_maintenance_crs_completo" type="object" class="" string="Crear CRS Completo"  invisible="((archive))" />
                                <field name="crs">
                                    <tree editable="false" create="false">
                                        <field name="estado" readonly="1"/>
                                        <field name="tipo_crs" readonly="1"/>
                                        <field name="n_cas" readonly="1"/>
                                        <field name="lugar" readonly="1"/>
                                        <field name="fecha" readonly="1"/>
                                        <field name="certificador" readonly="1"/>
                                        <field name="ref_em" readonly="1"/>
                                        <button name="edit_crs" string="Editar" class="oe_highlight" type="object"/>
                                        <button name="print_crs" string="Imprimir" type="object" class="oe_highlight"/>
                                    </tree>
                                </field>
                            </page>
                            <page name="page_form_one" string="Form One">
                                <button name="action_create_form_one" type="object" class="oe_highlight" string="Crear Form One"  invisible="((archive))" />
                                <field name="form_one_ids">
                                    <tree editable="false" create="false">
                                        <field name="estado" readonly="1"/>
                                        <field name="tracking_number" readonly="1"/>
                                        <field name="task_id" readonly="1"/>
                                        <field name="fecha" readonly="1"/>
                                        <button name="edit_form_one" string="Editar" class="oe_highlight" type="object"/>
                                        <button name="print_form_one" string="Imprimir" type="object" class="oe_highlight"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="Instructions" name="page_instrucciones">
                                <field name="note" placeholder="Describe el mantenimiento que harás..."/>
                            </page>
                            <page string="Notes" name="page_notas">
                                <field name="description" placeholder="Notas internas..."/>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" id="message_follower_ids"/>
                        <field name="activity_ids" id="activity_ids"/>
                        <field name="message_ids" id="message_ids"/>
                    </div>
                </form>
            </field>
        </record>

	    <record model="ir.actions.act_window" id="leulit_20231020_1222_action">
            <field name="name">Peticiones de Mantenimiento</field>
            <field name="res_model">maintenance.request</field>
            <field name="view_mode">kanban,tree,form,pivot,graph,calendar</field>
            <field name="view_id" ref="maintenance.hr_equipment_request_view_kanban"/>
            <field name="context">{'default_user_id': uid}</field>
        </record>
        <record model="ir.actions.act_window.view" id="leulit_20231020_1222_action_kanban">
            <field name="sequence" eval="1"/>
            <field name="view_mode">kanban</field>
            <field name="view_id" ref="maintenance.hr_equipment_request_view_kanban"/>
            <field name="act_window_id" ref="leulit_20231020_1222_action"/>
        </record>
        <record model="ir.actions.act_window.view" id="leulit_20231020_1222_action_tree">
            <field name="sequence" eval="2"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="maintenance.hr_equipment_request_view_tree"/>
            <field name="act_window_id" ref="leulit_20231020_1222_action"/>
        </record>
        <record model="ir.actions.act_window.view" id="leulit_20231020_1222_action_form">
            <field name="sequence" eval="3"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="leulit_20231020_1222_form"/>
            <field name="act_window_id" ref="leulit_20231020_1222_action"/>
        </record>

    </data>
</odoo>