<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Vista heredada de mgmtsystem.hazard (OCA) para añadir análisis de riesgos SGSI PART-IS -->
    <record id="view_mgmtsystem_hazard_form_partis_risk" model="ir.ui.view">
        <field name="name">mgmtsystem.hazard.form.partis.risk</field>
        <field name="model">mgmtsystem.hazard</field>
        <field name="inherit_id" ref="mgmtsystem_hazard.view_mgmtsystem_hazard_form"/>
        <field name="arch" type="xml">
            <xpath expr="//form/sheet" position="inside">
                <group string="Análisis PART-IS (SGSI)">
                    <group>
                        <field name="magerit_asset_id"/>
                        <field name="magerit_threat_id"/>
                        <field name="magerit_vulnerability_id" domain="['|', ('asset_ids', '=', False), ('asset_ids', '=', magerit_asset_id)]"/>
                    </group>
                    <group>
                        <field name="magerit_probability"/>
                        <field name="magerit_impact"/>
                        <field name="magerit_inherent_score" readonly="1"/>
                        <field name="magerit_inherent_level" readonly="1"/>
                    </group>
                </group>
                <group string="Tratamiento PART-IS (SGSI)">
                    <group>
                        <field name="pilar_treatment_strategy"/>
                        <field name="pilar_control_effectiveness"/>
                    </group>
                    <group>
                        <field name="pilar_control_ids" widget="many2many_tags"/>
                    </group>
                    <group>
                        <field name="pilar_control_summary" colspan="2"/>
                    </group>
                    <group string="Riesgo Residual">
                        <group>
                            <field name="pilar_residual_probability"/>
                            <field name="pilar_residual_impact"/>
                        </group>
                        <group>
                            <field name="pilar_residual_score" readonly="1"/>
                            <field name="pilar_residual_level" readonly="1"/>
                        </group>
                    </group>
                </group>
            </xpath>
        </field>
    </record>
</odoo>
